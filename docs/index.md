# Fediverse Tools for Joomla

**Joomla! extensions to integrate Mastodon with your site**

## What's this all about?

This is a package of Joomla!™ extensions which allow you to integrate Mastodon and ActivityPub in meaningful ways with your Joomla! site.

There are three levels of integration which can be used concurrently or independently of each other:
* **Consume**. You can display Mastodon posts and streams on your site.
* **Announce**. You can announce your Mastodon presence on your own site so that users who have your username and domain name can follow you on Mastodon, without having to explicitly tell them in advance your Mastodon handle.
* **Publish**. You can publish your own site's content into the Fediverse. Any ActivityPub user (Mastodon, PeerTube, Pixelfed, Tumblr, …) can “follow” an account on your site and see your site's posts in their feed.

Unlike other microblogging / social media integration extensions there is no privacy-invading JavaScript, no need for cookie banners, no centralised control of the published content. You are in full control of your content.

## Crash course in the Fediverse lingo

Mastodon is a microblogging platform, essentially a social network much like the infamous site with the bird logo. Unlike that site, Mastodon is neither closed source, nor centralised. It is Open Source, anyone can run a copy of it (called an “instance”), and instances can talk to each other — meaning that you can connect to your friends even if they have an account on a different server.

Each instance can have its own rules such as requiring someone to be a practitioner of a specific profession, or use a specific language for their posts. Some instances have a specific theme, e.g. art, open source software, etc. It's like the BBS of the 90s, only that instead of being isolated communities they can talk to each other and interconnect their members.

This ‘talking to each other’ part about Mastodon instances? It's called _federation_.

Third party software other than Mastodon can also federate with Mastodon instances and each other. That's why the term Mastodon is only used for the software, not the network of federated servers. The global sum total of federated servers is called the _Fediverse_, a portmanteau of “federation” and “universe”.

Federation takes place using [ActivityPub](https://www.w3.org/TR/activitypub/#client-to-server-interactions), a W3C standard which defines how servers talk to each other to exchange posts and other user-generated content.

ActivityPub users are called Actors. An _Actor_ can be a physical user (Alice, Bob, Charlie, …) or a virtual / abstract concept (news, blog, updates, …) acting as an aggregator of content.

ActivityPub Actors' posts are called _Activities_. An Activity is usually some kind of content announcement (an article, a comment, …), some action on the content (published, unpublished, edited, …), or anything else.

Mastodon is an ActivityPub implementation. Not all ActivityPub implementations are Mastodon, through. There are ActivityPub implementations for WordPress and Joomla (this here extension!). There is a YouTube clone called PeerTube based on ActivityPub. There is an Instagram clone called Pixelfed also based on ActivityPub. Tumblr will be adding ActivityPub support soon. All these disparate ActivityPub implementations can talk together using federation. That's the beauty of it. Just like HTML and CSS allowed the proliferation and interconnection of radically different websites, ActivityPub allows the same for social / activity feeds.  

Servers find out about each other's users using _WebFinger_, which is an Internet protocol ([RFC 7033](https://www.rfc-editor.org/rfc/rfc7033)) for retrieving information about the users of a site. WebFinger can be used on your Joomla site to advertise which Mastodon account a user of your site prefers to be contacted on, or tell other servers that a user on your site itself can be “followed” to provide posts the other servers can display to their own users.

The microblogging posts users make on a Mastodon instance are called _toots_. All toots are ActivityPub Activities. However, not all ActivityPub Activities are toots — only Activities concerning text and/or multimedia content generated by Mastodon are called tootls.

A toot contains plain text, by default up to 500 characters of it (depends on the Mastodon instance), and optionally media (images and videos). The entire post, or just some of its media files, can have a _content warning_ to indicate that they contain sensitive, triggering, inappropriate, NSFW (not suitable for word), or otherwise upsetting material — this is a lot like a “viewer discretion recommended” kind of warning. It is good practice that content warnings are taken into consideration and the content behind them be hidden by default, until the user chooses to display it.

## Extensions included

### Displaying toots

Fediverse Tools allows you to display individual toots or toot streams from any Mastodon user.

* [**Fediverse - Mastodon Feed** (Module)](mod_fediversefeed.md). Displays the public Mastodon feed of a user. Supports media (images and videos), as well as content warnings on the entire toot or just each media item.
* [**Content - Embed Toot** (Plugin)](plg_content_fediverse.md). A plugin to embed toots in articles, Custom HTML modules, and third party extensions which support Joomla's standard content events.

### WebFinger

WebFinger is an Internet protocol ([RFC 7033](https://www.rfc-editor.org/rfc/rfc7033)) which allows remote servers to query information about users on your site. You can use it to either publish information about your Mastodon presence (so you can be followed as `user@example.com` where example.com is _your Joomla site's domain name_, regardless of what your Mastodon handle is), or to let other ActivityPub / Mastodon users “follow” your site's content when used together with the ActivityPub component described in the next section.

* [**System - WebFinger** (Plugin)](plg_system_webfinger.md). Implements the WebFinger protocol (RFC 7033) in Joomla.
* [**WebFinger - Link to Mastodon** (Plugin)](plg_webfinger_mastodon.md). Add a link to your Mastodon identity in the WebFinger profile.

### Federating your content

Using the component and plugins in this section you can allow ActivityPub / Mastodon users to “follow” your site's content. This can be the content published by specific / any user on your site and some specific / any category, or content aggregators which group together content published by different authors and in different categories (think of a “blog” aggregator which aggregates all blog articles written by any author across all the blog-related categories on your site you tell it to use).

To put it simply, it lets other Mastodon (and, generally, ActivityPub) users to “follow” users on your site. When you publish an article it will appear on their feed like any other post!

* [**ActivityPub** (Component)](com_activitypub.md). The component which allows you to define ActivityPub Actors (users) and which handles the ActivityPub API — this enables federation of your site's content with third party ActivityPub servers such as Mastodon instances. Requires all other plugins in this section, as well as “System - WebFinger” to be published with their Access set to Public for content federation to work. Moreover, you will need a scheduled task of the “ActivityPub - Notify” type running every minute through Joomla's Scheduled Tasks.
* [**WebFinger - ActivityPub** (Plugin)](plg_webfinger_activitypub.md). Adds ActivityPub information in the WebFinger protocol (RFC 7033) responses. This lets other ActivityPub users (such as Mastodon users) to “follow” your content. Requires the System - WebFinger plugin to be enabled.
* [**Content - ActivityPub integration for Joomla articles** (Plugin)](plg_content_contentactivitypub.md). Provides the link between Joomla's Articles (`com_content`) and the ActivityPub component. This is what allows your _articles_ to be federated with other ActivityPub instances.
* [**Task - ActivityPub** (Plugin)](plg_task_activitypub.md). Provides the “ActivityPub - Notify” task type. You need a task of that type running every minute; it ‘pushes’ the content you publish into other federated ActivityPub (e.g. Mastodon) instances.
* [**Web Services - ActivityPub** (Plugin)](plg_webservices_activitypub.md). Enables the ActivityPub component's Joomla API part. Having this plugin published is **mandatory** for the ActivityPub component to work.

## Supported features

The following features are currently supported when displaying toots:

* **User information: avatar, username, display name** is shown for every toot (embed) or once on the module header (toots stream). This is linked back to the user's profile page on their Mastodon instance.
* **Toot language and RTL languages**. The content of each toot is marked with the language communicated by the server. If the language is using an RTL (Right-to-Left) script —as is the case for arabic or hebrew, for example— the content will be correctly displayed right-to-left.
* **Custom Emoji (in usernames and toots)**. Custom emoji images are loaded from the Mastodon server directly.
* **Content warnings on the entire toot**. The toot is rendered as an HTML DETAILS element with the Content Warning being the only visible content until the user clicks on it.
* **Sensitive media**. Sensitive media appear blurred until the user clicks on them.
* **Media previews**. Supported media files (see below) are shown with each toot using a tiled layout with the first media item preview appearing larger than the other ones. The (downscaled) preview image is displayed for each media file in the preview to save bandwidth and increase the page rendering performance. Clicking on it will load the full image.
* **Images**. Images are fully supported; Mastodon only uses web-safe image formats. 
* **Image descriptions**. Image descriptions are rendered as ALT tags for screen readers and also as a FIGCAPTION for sighted users (the latter only after clicking on the image).
* **Videos (both `video` and `gifv` types)** using the browser's native video player. The media preview shows the static frame (“poster frame”) sent by the Mastodon server. The video player only loads the video file when playing the video, to save bandwidth and make the page loading faster. 
* **Polls**. Poll results and the poll closing date and time appear in toots. You can not vote on the polls through the toot stream and embedded toots; you have to visit the toot on the Mastodon instance to do that.
* **Information about the toot visibility** (only in embeds). An icon with the visibility, public or unlisted, is displayed and presented as human-readable text with a `title` attribute and a visibly hidden (but screen reader announced) text. 
* **Information about the application used to post the toot** (only in embeds). The name of the application used to post the toot will be displayed and, if a link is provided, linked to as well.
* **Reply, reblog, and favourite counts** (only in embeds).
* **Dark Mode**. If your browser is set to use dark mode the software will use alternate rules to render the toots in a bright text on dark background color theme.

Features not supported (yet):

* Static custom emoji. Animated emoji are always loaded as moving images, regardless of the user's preferences on reduced motion. I understand this is an accessibility concern, and I'm trying to find a way to render the static custom emoji image provided by the server when the user prefers reduced motion.
* High contrast mode. Some users with certain types of visual impairment need a high contrast mode which is absolutely _not_ the same as Dark Mode (nor should the two ever be conflated). This is an accessibility issue I am aware of. I have to figure out how to set up high contrast on my own environment in a way that doesn't clash with my cognitive disability (ADHD) so I can work on it.
* Audio embeds. Audio embeds appear as being of an unknown type. An audio player will be used in a future version.

Features which will NOT be supported:

* Displaying private or direct message toots. For obvious reasons accessing these toots requires authenticating with the Mastodon instance using OAuth2. While it's possible to do that with a two-step process (with the user copying a token manually) I am not convinced there is a compelling, real-world use case where a (public) site would need to display this kind of privileged, unlisted information — or what the privacy implications would be for all parties involved.
* Directly launching a reply, reblog, or favourite from an embedded toot. Obviously, your site is NOT a Mastodon instance.
* Language written vertically. I speak none of them, and I am not sure CSS Flexbox can correctly support them. As far as I can tell, only Mongolian is always written top-to-bottom, and it's possible but optional for Chinese and Japanese to be written like that as well (though virtually all content in the latter languages uses left-to-right content flow). Just to be on the safe side, I'm using CSS classes referencing block, inline, start, and end instead of top, bottom, left, and right.